# -*- coding:utf-8 -*-
import matplotlib.pyplot as plt
import Utilities.plot_util as pu
import datetime
import numpy as np
ratio_index =  [ 3.22587428 , 3.00040434 , 2.85362355 , 2.43404659 , 2.32207312 , 2.14701299,2.37671713]
ratio_equity =  [ 2.52640633 , 2.46479514 , 1.59845745 , 1.88215105 , 2.92252251 , 2.01815558,  2.8180646 ]

dates =  [datetime.date(2015, 3, 3), datetime.date(2015, 3, 5), datetime.date(2015, 3, 9), datetime.date(2015, 3, 11), datetime.date(2015, 3, 12), datetime.date(2015, 3, 13), datetime.date(2015, 3, 16), datetime.date(2015, 3, 18), datetime.date(2015, 3, 19), datetime.date(2015, 3, 20), datetime.date(2015, 3, 23), datetime.date(2015, 3, 24), datetime.date(2015, 3, 25), datetime.date(2015, 4, 1), datetime.date(2015, 4, 2), datetime.date(2015, 4, 3), datetime.date(2015, 4, 7), datetime.date(2015, 4, 8), datetime.date(2015, 4, 9), datetime.date(2015, 4, 10), datetime.date(2015, 4, 13), datetime.date(2015, 4, 14), datetime.date(2015, 4, 15), datetime.date(2015, 4, 16), datetime.date(2015, 4, 17), datetime.date(2015, 4, 20), datetime.date(2015, 4, 21), datetime.date(2015, 4, 22), datetime.date(2015, 5, 4), datetime.date(2015, 5, 5), datetime.date(2015, 5, 6), datetime.date(2015, 5, 7), datetime.date(2015, 5, 8), datetime.date(2015, 5, 11), datetime.date(2015, 5, 12), datetime.date(2015, 5, 13), datetime.date(2015, 5, 14), datetime.date(2015, 5, 15), datetime.date(2015, 5, 18), datetime.date(2015, 5, 19), datetime.date(2015, 5, 20), datetime.date(2015, 5, 21), datetime.date(2015, 5, 22), datetime.date(2015, 5, 25), datetime.date(2015, 5, 26), datetime.date(2015, 5, 27), datetime.date(2015, 6, 1), datetime.date(2015, 6, 2), datetime.date(2015, 6, 3), datetime.date(2015, 6, 4), datetime.date(2015, 6, 5), datetime.date(2015, 6, 8), datetime.date(2015, 6, 9), datetime.date(2015, 6, 10), datetime.date(2015, 6, 11), datetime.date(2015, 6, 12), datetime.date(2015, 6, 15), datetime.date(2015, 6, 16), datetime.date(2015, 6, 17), datetime.date(2015, 6, 18), datetime.date(2015, 6, 19), datetime.date(2015, 6, 23), datetime.date(2015, 6, 24), datetime.date(2015, 7, 1), datetime.date(2015, 7, 2), datetime.date(2015, 7, 3), datetime.date(2015, 7, 6), datetime.date(2015, 7, 7), datetime.date(2015, 7, 8), datetime.date(2015, 7, 9), datetime.date(2015, 7, 10), datetime.date(2015, 7, 13), datetime.date(2015, 7, 14), datetime.date(2015, 7, 15), datetime.date(2015, 7, 16), datetime.date(2015, 7, 17), datetime.date(2015, 7, 20), datetime.date(2015, 7, 21), datetime.date(2015, 7, 22), datetime.date(2015, 8, 3), datetime.date(2015, 8, 4), datetime.date(2015, 8, 5), datetime.date(2015, 8, 6), datetime.date(2015, 8, 7), datetime.date(2015, 8, 10), datetime.date(2015, 8, 11), datetime.date(2015, 8, 12), datetime.date(2015, 8, 13), datetime.date(2015, 8, 14), datetime.date(2015, 8, 17), datetime.date(2015, 8, 18), datetime.date(2015, 8, 19), datetime.date(2015, 8, 20), datetime.date(2015, 8, 21), datetime.date(2015, 8, 24), datetime.date(2015, 8, 25), datetime.date(2015, 8, 26), datetime.date(2015, 9, 1), datetime.date(2015, 9, 2), datetime.date(2015, 9, 7), datetime.date(2015, 9, 8), datetime.date(2015, 9, 9), datetime.date(2015, 9, 10), datetime.date(2015, 9, 11), datetime.date(2015, 9, 14), datetime.date(2015, 9, 15), datetime.date(2015, 9, 16), datetime.date(2015, 9, 17), datetime.date(2015, 9, 18), datetime.date(2015, 9, 21), datetime.date(2015, 9, 22), datetime.date(2015, 9, 23), datetime.date(2015, 10, 8), datetime.date(2015, 10, 9), datetime.date(2015, 10, 12), datetime.date(2015, 10, 13), datetime.date(2015, 10, 14), datetime.date(2015, 10, 15), datetime.date(2015, 10, 16), datetime.date(2015, 10, 19), datetime.date(2015, 10, 20), datetime.date(2015, 10, 21), datetime.date(2015, 10, 23), datetime.date(2015, 10, 26), datetime.date(2015, 10, 27), datetime.date(2015, 10, 28), datetime.date(2015, 11, 2), datetime.date(2015, 11, 3), datetime.date(2015, 11, 4), datetime.date(2015, 11, 5), datetime.date(2015, 11, 6), datetime.date(2015, 11, 9), datetime.date(2015, 11, 10), datetime.date(2015, 11, 11), datetime.date(2015, 11, 12), datetime.date(2015, 11, 13), datetime.date(2015, 11, 16), datetime.date(2015, 11, 17), datetime.date(2015, 11, 18), datetime.date(2015, 11, 19), datetime.date(2015, 11, 20), datetime.date(2015, 11, 23), datetime.date(2015, 11, 24), datetime.date(2015, 11, 25), datetime.date(2015, 12, 1), datetime.date(2015, 12, 2), datetime.date(2015, 12, 3), datetime.date(2015, 12, 4), datetime.date(2015, 12, 7), datetime.date(2015, 12, 8), datetime.date(2015, 12, 9), datetime.date(2015, 12, 10), datetime.date(2015, 12, 11), datetime.date(2015, 12, 14), datetime.date(2015, 12, 15), datetime.date(2015, 12, 16), datetime.date(2015, 12, 17), datetime.date(2015, 12, 18), datetime.date(2015, 12, 21), datetime.date(2015, 12, 22), datetime.date(2015, 12, 23), datetime.date(2016, 1, 4), datetime.date(2016, 1, 5), datetime.date(2016, 1, 6), datetime.date(2016, 1, 7), datetime.date(2016, 1, 8), datetime.date(2016, 1, 11), datetime.date(2016, 1, 12), datetime.date(2016, 1, 13), datetime.date(2016, 1, 14), datetime.date(2016, 1, 15), datetime.date(2016, 1, 18), datetime.date(2016, 1, 19), datetime.date(2016, 1, 20), datetime.date(2016, 1, 21), datetime.date(2016, 1, 22), datetime.date(2016, 1, 25), datetime.date(2016, 1, 26), datetime.date(2016, 1, 27), datetime.date(2016, 2, 1), datetime.date(2016, 2, 2), datetime.date(2016, 2, 3), datetime.date(2016, 2, 4), datetime.date(2016, 2, 5), datetime.date(2016, 2, 15), datetime.date(2016, 2, 16), datetime.date(2016, 2, 17), datetime.date(2016, 2, 18), datetime.date(2016, 2, 19), datetime.date(2016, 2, 22), datetime.date(2016, 2, 23), datetime.date(2016, 2, 24), datetime.date(2016, 3, 1), datetime.date(2016, 3, 2), datetime.date(2016, 3, 3), datetime.date(2016, 3, 4), datetime.date(2016, 3, 7), datetime.date(2016, 3, 8), datetime.date(2016, 3, 9), datetime.date(2016, 3, 10), datetime.date(2016, 3, 11), datetime.date(2016, 3, 14), datetime.date(2016, 3, 15), datetime.date(2016, 3, 16), datetime.date(2016, 3, 17), datetime.date(2016, 3, 18), datetime.date(2016, 3, 21), datetime.date(2016, 3, 22), datetime.date(2016, 3, 23), datetime.date(2016, 4, 1), datetime.date(2016, 4, 5), datetime.date(2016, 4, 6), datetime.date(2016, 4, 7), datetime.date(2016, 4, 8), datetime.date(2016, 4, 11), datetime.date(2016, 4, 12), datetime.date(2016, 4, 13), datetime.date(2016, 4, 14), datetime.date(2016, 4, 15), datetime.date(2016, 4, 18), datetime.date(2016, 4, 19), datetime.date(2016, 4, 20), datetime.date(2016, 4, 21), datetime.date(2016, 4, 22), datetime.date(2016, 4, 25), datetime.date(2016, 4, 26), datetime.date(2016, 4, 27), datetime.date(2016, 5, 3), datetime.date(2016, 5, 4), datetime.date(2016, 5, 5), datetime.date(2016, 5, 6), datetime.date(2016, 5, 9), datetime.date(2016, 5, 10), datetime.date(2016, 5, 11), datetime.date(2016, 5, 12), datetime.date(2016, 5, 13), datetime.date(2016, 5, 16), datetime.date(2016, 5, 17), datetime.date(2016, 5, 18), datetime.date(2016, 5, 19), datetime.date(2016, 5, 20), datetime.date(2016, 5, 23), datetime.date(2016, 5, 24), datetime.date(2016, 5, 25), datetime.date(2016, 6, 1), datetime.date(2016, 6, 2), datetime.date(2016, 6, 3), datetime.date(2016, 6, 6), datetime.date(2016, 6, 7), datetime.date(2016, 6, 8), datetime.date(2016, 6, 13), datetime.date(2016, 6, 14), datetime.date(2016, 6, 15), datetime.date(2016, 6, 16), datetime.date(2016, 6, 17), datetime.date(2016, 6, 20), datetime.date(2016, 6, 21), datetime.date(2016, 6, 22), datetime.date(2016, 7, 1), datetime.date(2016, 7, 4), datetime.date(2016, 7, 5), datetime.date(2016, 7, 6), datetime.date(2016, 7, 7), datetime.date(2016, 7, 8), datetime.date(2016, 7, 11), datetime.date(2016, 7, 12), datetime.date(2016, 7, 13), datetime.date(2016, 7, 14), datetime.date(2016, 7, 15), datetime.date(2016, 7, 18), datetime.date(2016, 7, 19), datetime.date(2016, 7, 20), datetime.date(2016, 7, 21), datetime.date(2016, 7, 22), datetime.date(2016, 7, 25), datetime.date(2016, 7, 26), datetime.date(2016, 7, 27), datetime.date(2016, 8, 1), datetime.date(2016, 8, 2), datetime.date(2016, 8, 3), datetime.date(2016, 8, 4), datetime.date(2016, 8, 5), datetime.date(2016, 8, 8), datetime.date(2016, 8, 9), datetime.date(2016, 8, 10), datetime.date(2016, 8, 11), datetime.date(2016, 8, 12), datetime.date(2016, 8, 15), datetime.date(2016, 8, 16), datetime.date(2016, 8, 17), datetime.date(2016, 8, 18), datetime.date(2016, 8, 19), datetime.date(2016, 8, 22), datetime.date(2016, 8, 23), datetime.date(2016, 8, 24), datetime.date(2016, 9, 1), datetime.date(2016, 9, 2), datetime.date(2016, 9, 5), datetime.date(2016, 9, 6), datetime.date(2016, 9, 7), datetime.date(2016, 9, 8), datetime.date(2016, 9, 9), datetime.date(2016, 9, 12), datetime.date(2016, 9, 13), datetime.date(2016, 9, 14), datetime.date(2016, 9, 19), datetime.date(2016, 9, 20), datetime.date(2016, 9, 21), datetime.date(2016, 9, 22), datetime.date(2016, 9, 23), datetime.date(2016, 9, 26), datetime.date(2016, 9, 27), datetime.date(2016, 9, 28), datetime.date(2016, 10, 10), datetime.date(2016, 10, 11), datetime.date(2016, 10, 12), datetime.date(2016, 10, 13), datetime.date(2016, 10, 14), datetime.date(2016, 10, 17), datetime.date(2016, 10, 18), datetime.date(2016, 10, 19), datetime.date(2016, 10, 20), datetime.date(2016, 10, 21), datetime.date(2016, 10, 24), datetime.date(2016, 10, 25), datetime.date(2016, 10, 26), datetime.date(2016, 11, 1), datetime.date(2016, 11, 2), datetime.date(2016, 11, 3), datetime.date(2016, 11, 4), datetime.date(2016, 11, 7), datetime.date(2016, 11, 8), datetime.date(2016, 11, 9), datetime.date(2016, 11, 10), datetime.date(2016, 11, 11), datetime.date(2016, 11, 14), datetime.date(2016, 11, 15), datetime.date(2016, 11, 16), datetime.date(2016, 11, 17), datetime.date(2016, 11, 18), datetime.date(2016, 11, 21), datetime.date(2016, 11, 22), datetime.date(2016, 11, 23), datetime.date(2016, 12, 1), datetime.date(2016, 12, 2), datetime.date(2016, 12, 5), datetime.date(2016, 12, 6), datetime.date(2016, 12, 7), datetime.date(2016, 12, 8), datetime.date(2016, 12, 9), datetime.date(2016, 12, 12), datetime.date(2016, 12, 13), datetime.date(2016, 12, 14), datetime.date(2016, 12, 15), datetime.date(2016, 12, 16), datetime.date(2016, 12, 19), datetime.date(2016, 12, 20), datetime.date(2016, 12, 21), datetime.date(2016, 12, 22), datetime.date(2016, 12, 23), datetime.date(2016, 12, 26), datetime.date(2016, 12, 27), datetime.date(2016, 12, 28), datetime.date(2017, 1, 3), datetime.date(2017, 1, 4), datetime.date(2017, 1, 5), datetime.date(2017, 1, 6), datetime.date(2017, 1, 9), datetime.date(2017, 1, 10), datetime.date(2017, 1, 11), datetime.date(2017, 1, 12), datetime.date(2017, 1, 13), datetime.date(2017, 1, 16), datetime.date(2017, 1, 17), datetime.date(2017, 1, 18), datetime.date(2017, 1, 19), datetime.date(2017, 1, 20), datetime.date(2017, 1, 23), datetime.date(2017, 1, 24), datetime.date(2017, 1, 25), datetime.date(2017, 2, 3), datetime.date(2017, 2, 6), datetime.date(2017, 2, 7), datetime.date(2017, 2, 8), datetime.date(2017, 2, 9), datetime.date(2017, 2, 10), datetime.date(2017, 2, 13), datetime.date(2017, 2, 14), datetime.date(2017, 2, 15), datetime.date(2017, 2, 16), datetime.date(2017, 2, 17), datetime.date(2017, 2, 20), datetime.date(2017, 2, 21), datetime.date(2017, 2, 22), datetime.date(2017, 3, 1), datetime.date(2017, 3, 2), datetime.date(2017, 3, 3), datetime.date(2017, 3, 6), datetime.date(2017, 3, 7), datetime.date(2017, 3, 8), datetime.date(2017, 3, 9), datetime.date(2017, 3, 10), datetime.date(2017, 3, 13), datetime.date(2017, 3, 14), datetime.date(2017, 3, 15), datetime.date(2017, 3, 16), datetime.date(2017, 3, 17), datetime.date(2017, 3, 20), datetime.date(2017, 3, 21), datetime.date(2017, 3, 22), datetime.date(2017, 4, 5), datetime.date(2017, 4, 6), datetime.date(2017, 4, 7), datetime.date(2017, 4, 10), datetime.date(2017, 4, 11), datetime.date(2017, 4, 12), datetime.date(2017, 4, 13), datetime.date(2017, 4, 14), datetime.date(2017, 4, 17), datetime.date(2017, 4, 18), datetime.date(2017, 4, 19), datetime.date(2017, 4, 20), datetime.date(2017, 4, 21), datetime.date(2017, 4, 24), datetime.date(2017, 4, 25), datetime.date(2017, 4, 26), datetime.date(2017, 5, 2), datetime.date(2017, 5, 3), datetime.date(2017, 5, 4), datetime.date(2017, 5, 5), datetime.date(2017, 5, 8), datetime.date(2017, 5, 9), datetime.date(2017, 5, 10), datetime.date(2017, 5, 11), datetime.date(2017, 5, 12), datetime.date(2017, 5, 15), datetime.date(2017, 5, 16), datetime.date(2017, 5, 17), datetime.date(2017, 5, 18), datetime.date(2017, 5, 19), datetime.date(2017, 5, 22), datetime.date(2017, 5, 23), datetime.date(2017, 5, 24), datetime.date(2017, 6, 1), datetime.date(2017, 6, 2), datetime.date(2017, 6, 5), datetime.date(2017, 6, 6), datetime.date(2017, 6, 7), datetime.date(2017, 6, 8), datetime.date(2017, 6, 9), datetime.date(2017, 6, 12), datetime.date(2017, 6, 13), datetime.date(2017, 6, 14), datetime.date(2017, 6, 15), datetime.date(2017, 6, 16), datetime.date(2017, 6, 19), datetime.date(2017, 6, 20), datetime.date(2017, 6, 21), datetime.date(2017, 6, 22), datetime.date(2017, 6, 23), datetime.date(2017, 6, 26), datetime.date(2017, 6, 27), datetime.date(2017, 6, 28), datetime.date(2017, 7, 3), datetime.date(2017, 7, 4), datetime.date(2017, 7, 5), datetime.date(2017, 7, 6), datetime.date(2017, 7, 7), datetime.date(2017, 7, 10), datetime.date(2017, 7, 11), datetime.date(2017, 7, 12), datetime.date(2017, 7, 13), datetime.date(2017, 7, 14), datetime.date(2017, 7, 17), datetime.date(2017, 7, 18), datetime.date(2017, 7, 19), datetime.date(2017, 7, 20)
          ]
call_volum_months_sum = [7.397931000000001, 11.845187000000001, 19.113988, 8.852899, 20.206015, 12.101106000000001,
                         16.410843, 18.299794, 18.721467000000004, 35.052789, 20.404774, 20.462028999999998, 25.903738,
                         24.194988000000002, 19.337719, 15.647157, 21.725302, 37.217749, 45.342995, 26.10616,
                         45.320845999999996, 38.813843999999996, 48.322144, 53.00606399999999, 65.71285400000001,
                         69.515533, 33.490772, 38.950732, 23.027005000000003, 46.562242999999995, 40.270404,
                         37.887578000000005, 40.26135299999999, 34.656302000000004, 34.25979, 27.556036000000002,
                         20.277526, 30.063055999999996, 32.396547, 44.484681, 58.14268000000001, 44.410228000000004,
                         58.238402, 96.19804299999998, 89.339585, 74.941725, 55.78232500000001, 50.66564, 48.694454,
                         97.11791600000001, 64.3204, 113.111249, 76.490276, 49.564521, 57.663828, 44.199962,
                         53.837256000000004, 49.67962, 40.824403, 43.483847999999995, 68.72375400000001,
                         82.41834700000001, 68.97697600000001, 93.04584200000001, 118.756446, 107.614675, 123.193604,
                         86.627878, 73.47691999999999, 122.959988, 227.81256, 103.572046, 82.75009, 62.465788,
                         64.322002, 72.120154, 68.78333899999998, 52.055842, 39.407337999999996, 35.674567,
                         41.573651000000005, 43.14299900000001, 41.409420999999995, 21.868190000000002, 68.497465,
                         53.648904, 45.804219, 38.759912, 34.56457, 42.31565700000001, 49.220864, 47.408549,
                         45.405032000000006, 45.071183, 46.420172, 72.561958, 102.072975, 111.87235599999998,
                         104.989542, 75.503764, 57.538869000000005, 70.99049600000001, 40.951429, 35.690545,
                         57.321974999999995, 41.878232, 48.505318, 56.583305, 39.450579, 37.948258, 50.485636,
                         37.809117, 36.67741, 24.138424, 113.40479199999999, 41.909226000000004, 39.658041000000004,
                         44.401022000000005, 63.782734000000005, 50.58826500000001, 44.816955, 82.29213,
                         47.22036800000001, 73.32138699999999, 58.092084, 44.061287, 21.315811999999998, 22.376016,
                         78.77303999999998, 183.021287, 121.949604, 192.08870899999997, 112.25672600000001,
                         90.79180000000001, 65.02887, 65.00789300000001, 45.575888000000006, 96.550717, 80.20355,
                         58.652008, 55.851763, 68.573893, 67.97936, 72.99208599999999, 78.95943199999999, 172.084225,
                         157.947496, 131.604629, 79.57196699999999, 68.862627, 74.340947, 96.572416, 75.65020100000001,
                         85.18210400000001, 77.2755, 60.170091, 121.53823299999999, 106.440345, 146.124441,
                         98.20789400000001, 137.813013, 54.754338, 82.247094, 58.292834, 10.471748999999999,
                         97.67998399999999, 71.41047300000001, 76.98765100000001, 60.426311, 75.340591, 61.11324,
                         59.737945, 69.403035, 50.968056, 54.914618000000004, 47.017911999999995, 38.559644,
                         46.73440300000001, 65.543955, 48.820187999999995, 44.834540999999994, 36.640183,
                         42.121134000000005, 26.720428, 39.76189599999999, 63.913818, 45.044250999999996, 54.676932,
                         34.716196, 77.073912, 44.650175000000004, 46.988842000000005, 71.37992399999999, 118.807418,
                         91.382317, 153.30235199999998, 102.592414, 95.262747, 70.523545, 60.004274, 66.470513,
                         118.27613299999999, 77.72277100000001, 107.21641299999999, 129.93078400000002, 120.252465,
                         162.313279, 83.392432, 86.73434099999999, 77.069741, 98.05146100000002, 58.225912, 74.828885,
                         63.473144, 76.288619, 45.580505, 125.99323299999999, 68.943824, 88.55500599999999,
                         70.14742700000001, 53.50629000000001, 94.874258, 76.931313, 59.283046, 48.34536,
                         54.029695999999994, 46.516965, 72.58767399999999, 37.689865000000005, 30.047808000000003,
                         57.229511, 58.973318000000006, 39.176962, 38.01421, 51.614731000000006, 32.82348, 35.294438,
                         35.024706, 46.162113999999995, 34.396363, 31.92692, 46.813669, 35.045444, 36.819498, 79.953222,
                         49.741815, 74.64189400000001, 52.407618, 37.865737, 45.284772000000004, 74.00645699999998,
                         60.042024, 98.04983, 64.392543, 83.810928, 63.556034, 89.659263, 58.266678, 47.128058,
                         121.94762899999999, 77.987027, 72.452552, 68.75826, 59.472783, 127.401976, 187.12840999999997,
                         267.836002, 82.94123, 84.920785, 85.083849, 95.46283700000001, 58.704039, 84.444492, 76.478883,
                         73.860455, 109.042467, 158.581367, 66.152794, 54.534216, 49.906173, 68.718012,
                         62.194314999999996, 63.163788999999994, 81.208431, 73.860071, 167.82960000000003, 177.097234,
                         575.240588, 262.889522, 140.98442300000002, 145.43323, 100.35011200000001, 97.135656,
                         144.85017200000001, 130.740575, 126.981387, 112.08263000000001, 138.071958, 159.026147,
                         133.346273, 77.534896, 98.452953, 163.78786399999998, 74.73931400000001, 55.23264, 79.10421,
                         47.060428, 63.51171600000001, 138.836847, 63.313172, 98.84168199999999, 82.839828,
                         78.83127900000001, 103.20998900000001, 66.555005, 52.815943000000004, 58.165777, 81.29492,
                         85.565388, 137.049089, 124.284541, 78.287643, 138.523509, 312.61867600000005,
                         119.01670600000001, 115.792624, 120.83748200000001, 109.971821, 267.666446, 154.784929,
                         99.527732, 201.043066, 291.904899, 189.912997, 272.80881800000003, 372.991927,
                         148.81950600000002, 120.991706, 131.40990399999998, 119.820624, 375.605561, 290.680978,
                         352.418711, 342.234726, 285.242619, 245.97271800000001, 132.859456, 119.69756699999999,
                         127.24706300000001, 298.5831, 314.26659100000006, 153.886685, 123.19664900000001, 210.040359,
                         109.710977, 91.00012200000002, 121.64810600000001, 122.163231, 73.023096, 75.003776,
                         110.451224, 82.387718, 77.734102, 119.53742199999999, 102.547587, 74.64500799999999, 64.40051,
                         70.378979, 59.610431000000005, 76.638538, 75.342593, 114.575139, 196.064038, 104.586283,
                         165.92156500000002, 110.44482199999999, 101.46269000000001, 107.44876199999999, 74.116159,
                         83.030093, 110.072717, 84.013949, 78.50105500000001, 119.573241, 165.865683, 186.61028,
                         163.064237, 93.06588899999998, 160.907322, 102.919466, 219.238818, 249.163084, 219.536122,
                         145.368558, 126.09739599999999, 154.472324, 101.90995899999999, 95.656686, 74.78699499999999,
                         72.224929, 114.150346, 77.03894899999999, 139.7841, 91.115341, 98.764317, 177.96148099999996,
                         140.504583, 103.783885, 104.71260900000001, 120.29583800000002, 173.36894999999998, 129.085252,
                         106.99165500000001, 72.41948199999999, 173.389607, 116.162941, 73.04545200000001,
                         103.14964400000001, 104.90404300000002, 57.982716, 109.59376499999999, 78.157296,
                         105.14619600000002, 117.699195, 97.428359, 134.896429, 54.768203, 66.47835400000001, 71.292275,
                         106.111931, 82.192317, 53.935005000000004, 90.849002, 99.211239, 212.670116, 167.718314,
                         120.59736199999999, 94.01809399999999, 84.673473, 69.960328, 146.860338, 292.437328,
                         229.67908199999997, 236.383558, 226.537947, 173.93857400000002, 173.234281, 277.60529299999996,
                         272.14910100000003, 453.513101, 282.417103, 232.52275, 242.427875, 195.785069, 142.840791,
                         254.04296399999996, 187.896207, 241.330184, 553.5051520000001, 330.1450469999999, 454.021088,
                         333.62165300000004, 309.675433, 159.255302, 166.322421, 269.033745, 299.854123,
                         193.06131000000002, 205.80772900000002, 474.395792, 493.469552, 388.75727600000005,
                         480.2707659999999, 908.31269, 494.442153, 597.659475, 452.905253
                         ]
put_volum_months_sum = [3.848428, 13.075586, 27.115653000000002, 6.185327000000001, 6.491772999999999, 3.298691,
                        3.86368, 4.126527, 3.305707, 7.302209, 5.954543999999999, 6.071004, 7.211009, 5.60217,
                        5.4614009999999995, 4.937010999999999, 5.916409, 8.10425, 8.96873, 6.60278, 9.221069, 8.191026,
                        8.390111, 8.269193999999999, 12.045862999999999, 16.833343, 10.741194, 9.175191, 9.641488,
                        21.178668000000002, 24.574213000000004, 20.541317, 17.720585, 15.582693999999998, 12.122398,
                        9.575854, 11.264459, 23.329949000000003, 32.006378000000005, 25.936621000000002, 24.424965,
                        17.882819, 17.443952, 15.000421, 17.498666999999998, 15.116950000000001, 24.734478,
                        21.643559999999997, 19.247548, 44.512398, 22.958093999999996, 29.587177999999998,
                        24.557264999999997, 24.353114, 32.818954, 27.472488999999996, 35.277144, 49.174015, 45.303042,
                        60.560100999999996, 80.504665, 120.274926, 68.638943, 62.829942, 112.468097, 131.713081,
                        66.150683, 72.667039, 90.885379, 108.99687200000001, 83.546513, 64.70060000000001, 79.247078,
                        94.965834, 70.06329699999999, 46.378848999999995, 61.98802599999999, 58.309340000000006,
                        45.017546, 79.45902699999999, 61.018675, 56.658483000000004, 62.801262, 21.980892, 48.625487,
                        35.83245900000001, 39.839952000000004, 48.312427, 35.17715, 101.58962799999999,
                        152.33135499999997, 166.40196699999998, 110.20663400000001, 161.121643, 354.04537, 380.665429,
                        307.33779599999997, 118.490763, 146.13302199999998, 98.991601, 83.294996, 66.532253,
                        46.408232000000005, 48.645902, 78.626454, 75.161565, 75.17593499999998, 41.590823,
                        42.298564999999996, 33.599477, 30.774853999999998, 41.517120999999996, 21.787761, 18.607003,
                        27.580714, 18.301311000000002, 23.909009, 22.231103, 20.228119, 22.262118000000005, 25.472572,
                        45.92574300000001, 25.329866, 25.411026, 35.694408, 29.913273999999998, 24.047036000000002,
                        24.220042, 49.182103, 61.257114, 43.090365000000006, 48.795373, 46.81836, 54.93549900000001,
                        42.515487, 50.144709, 44.84622699999999, 51.141737, 48.574434, 44.783937, 35.622367, 64.683335,
                        66.67751899999999, 59.77990600000001, 80.13140899999999, 116.41543500000002, 68.841824,
                        106.961949, 82.804676, 91.605743, 66.68302100000001, 78.469612, 78.41728499999999,
                        88.37659999999998, 55.62161400000001, 59.311568, 63.978207, 63.910223, 66.189572, 32.035327,
                        60.056611999999994, 85.866781, 155.657337, 62.121733, 31.313044999999995, 221.19117999999997,
                        166.60796100000002, 126.38590799999999, 99.081988, 135.751689, 154.28052999999997, 100.313208,
                        109.136822, 94.938862, 126.104633, 124.676538, 81.942188, 144.611601, 186.26350999999997,
                        76.200542, 58.80129499999999, 67.326191, 47.820456, 34.488789, 69.161903, 56.192023000000006,
                        51.437004, 50.838584, 68.520407, 63.219127, 53.656921, 51.078797, 123.57888100000001,
                        82.23729499999999, 55.142202000000005, 97.591705, 52.747645000000006, 88.27765499999998,
                        56.19297, 46.70922999999999, 59.549064, 64.81723000000001, 58.393904, 73.047969, 80.482904,
                        62.77203300000001, 54.020179999999996, 44.249284, 50.922107000000004, 45.228169, 43.70637,
                        29.832386999999997, 44.815670000000004, 51.755069999999996, 45.240141, 35.030468,
                        53.965160999999995, 32.587113, 33.072832000000005, 36.747448, 34.76422300000001, 101.15411,
                        58.335910000000005, 42.056236999999996, 42.601615, 37.10744, 32.978724, 51.407714999999996,
                        30.118243, 27.56501, 77.25402, 123.18151200000001, 65.703485, 55.621804, 78.760682, 39.89705,
                        57.741003, 47.560053, 74.641407, 42.946192999999994, 39.898383, 44.757789, 47.055186,
                        43.415735999999995, 41.840937, 34.320387000000004, 48.359221000000005, 35.336751,
                        25.229355999999996, 39.603342999999995, 72.19100300000001, 86.85892000000001, 90.962069,
                        62.654037, 64.591598, 57.380632000000006, 62.410292000000005, 47.001177, 24.522070000000003,
                        50.37433999999999, 36.803155000000004, 39.263514, 34.916095, 35.971103, 55.850485, 61.989074,
                        57.043502999999994, 33.534112, 34.155443, 38.626457, 65.484384, 42.598391, 46.54910400000001,
                        45.997673000000006, 41.061245, 47.834933, 99.840439, 56.067803000000005, 38.40275, 41.292218,
                        60.84714699999999, 43.546731, 42.503455, 40.96637, 30.697668, 64.828591, 58.251866,
                        90.43965800000001, 87.10541, 58.534741000000004, 58.562299, 50.632768, 46.296794999999996,
                        52.821206999999994, 60.912563, 41.20931100000001, 49.795758, 44.703721, 60.348537,
                        45.12695299999999, 33.473325, 44.329961000000004, 139.754059, 56.201778, 58.588256, 60.299218,
                        45.377989, 54.984883999999994, 75.410057, 41.856896, 96.165277, 95.80428500000001, 60.983295,
                        58.887747, 35.121378, 33.261390999999996, 33.829282000000006, 44.512283000000004, 59.414491,
                        73.966741, 56.131665, 37.858694, 70.355295, 103.241093, 42.987926, 44.320074, 49.513915, 56.304,
                        108.612116, 55.927755000000005, 43.780341, 75.571082, 164.860418, 73.883776, 86.38779099999999,
                        95.969706, 50.81872499999999, 40.437688, 49.208534, 42.078483, 104.12226800000002, 75.737055,
                        72.323678, 115.10306999999999, 120.923763, 157.764983, 87.961807, 92.11255299999999,
                        73.22029599999999, 119.252884, 186.183205, 104.84231, 78.875002, 339.02258699999993, 130.715815,
                        149.716337, 301.78578999999996, 148.496831, 96.03862799999999, 106.191214, 200.24795699999999,
                        93.489216, 108.76864599999999, 82.592576, 75.657031, 53.870512, 49.871838, 54.16629800000001,
                        53.67156, 98.238219, 88.725559, 126.33698700000001, 219.924928, 81.45999, 94.95694499999999,
                        81.166272, 67.640674, 60.43969899999999, 39.166359, 43.684618, 63.623472, 62.634716, 63.481686,
                        87.41026699999999, 84.69146099999999, 78.387305, 60.886174999999994, 54.42342099999999,
                        79.316387, 60.935542, 118.01101700000001, 133.29556599999998, 82.957748, 58.014895, 79.406971,
                        111.809638, 117.02883800000001, 89.179977, 63.543351, 57.778801, 121.95527200000001, 82.113272,
                        137.94105299999998, 69.32558300000001, 88.32918099999999, 101.27545900000001, 120.436605,
                        100.527765, 92.243239, 134.823317, 85.52232000000001, 73.40640099999999, 63.965633000000004,
                        42.174363, 132.801343, 78.109805, 57.270478000000004, 102.67331300000001, 107.70783699999998,
                        61.966685999999996, 166.35101, 108.47882899999999, 117.904663, 129.035621, 88.50469500000001,
                        102.813837, 48.58935, 67.21079900000001, 83.114335, 166.927856, 120.415026, 68.079368,
                        79.181301, 84.24271399999999, 122.84816900000001, 80.57963699999999, 68.89413, 52.573094,
                        87.886021, 49.035299, 74.833048, 102.684879, 97.9975, 82.575856, 97.510131, 118.468739,
                        85.12680399999999, 94.816999, 87.30951, 117.564367, 101.41368899999999, 102.99163099999998,
                        126.434021, 131.01344500000002, 85.33215299999999, 103.49073, 96.988923, 104.78893899999998,
                        150.56451299999998, 119.295806, 107.26662099999999, 98.332176, 93.454691, 106.52676399999999,
                        118.760156, 126.873792, 109.784693, 82.81872899999999, 76.43393900000001, 146.326141,
                        173.687112, 131.198852, 153.30331299999997, 199.678749, 164.223777, 144.31750399999999,
                        140.70719
                        ]
volumes = []
month_volumes = {}
idx = dates.index(datetime.date(2016, 12, 28))+1
month = dates[idx].month
print(month)
volume = 0.0
for i in range(idx,len(call_volum_months_sum)):
    if dates[i].month == month:
        volume += call_volum_months_sum[i] + put_volum_months_sum[i]
    else:
        month_volumes.update({month:volume})
        volumes.append(volume)
        month = dates[i].month
        volume = 0.0
        volume += call_volum_months_sum[i] + put_volum_months_sum[i]
month_volumes.update({month:volume})
volumes.append(volume)
print(volumes)
print(month_volumes)

rates = []
for j in month_volumes.keys():
    if j == 1: continue
    rates.append((month_volumes[j]-month_volumes[j-1])/month_volumes[j-1])
print(rates)
#avg_increase = sum(rates)/len(rates)
avg_increase = 0.05
avg_indexratio = sum(ratio_index)/len(ratio_index)
avg_equityratio = sum(ratio_equity)/len(ratio_equity)
print('average increase rate : ',avg_increase)


expected_etfs = []
expected_indexs = []
expected_equities = []
etf_18 = volumes[-1]*(1+avg_increase)**5
for n in range(12):
    etf_18 = etf_18*(1+avg_increase)
    expected_etfs.append(etf_18)
    index = etf_18*avg_indexratio
    expected_indexs.append(index)
    equity =etf_18*avg_equityratio
    expected_equities.append(equity)

print('expected_etfs : ',expected_etfs)
print('expected_indexs',expected_indexs)

plt.rcParams['font.sans-serif'] = ['STKaiti']
plt.rcParams.update({'font.size': 15})
f, axarr = plt.subplots()
w = 0.15
x = np.arange(len(volumes))
axarr.bar(x,volumes,width =w, color=pu.c1,label = '50ETF期权成交额')
lgd = axarr.legend()
axarr.set_xticks(x)
axarr.set_xticklabels(['01/17','02/17','03/17','04/17','05/17','06/17','07/17'])
axarr.set_ylabel('成交额（百万）')

f1, axarr1 = plt.subplots()
x = np.arange(len(expected_etfs))
axarr1.bar(x,expected_etfs,width =w, color=pu.c1,label = '50ETF期权')
axarr1.bar(x+w,expected_equities,width =w, color=pu.c2,label = '个股期权')
axarr1.bar(x+w*2,expected_indexs,width =w, color=pu.c3,label = '沪深300指数期权')
lgd1 = axarr1.legend(bbox_to_anchor=(0., 1.02, 1.1, .102), loc=3,
           ncol=3, borderaxespad=0.,columnspacing=0.5,frameon=False)
axarr1.set_xticks(x)
axarr1.set_xticklabels(['01/18','02/18','03/18','04/18','05/18','06/18','07/18','08/18','09/18','10/18','11/18','12/18'])
axarr1.set_ylabel('成交额（百万）')


pu.set_frame([axarr,axarr1])


for label in axarr.get_xmajorticklabels() and axarr1.get_xmajorticklabels():
    label.set_rotation(270)
    label.set_horizontalalignment("right")

f.savefig('volume_50.png', dpi=500, format='png', bbox_extra_artists=(lgd,), bbox_inches='tight')
f1.savefig('volume_50_expected.png', dpi=500, format='png', bbox_extra_artists=(lgd1,), bbox_inches='tight')

plt.draw()
plt.show()
